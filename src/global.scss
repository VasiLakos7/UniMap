/* Google Font: Manrope (real weights 200..800) */
@import url('https://fonts.googleapis.com/css2?family=Manrope:wght@200..800&display=swap');

/* Ionic core */
@import "@ionic/angular/css/core.css";

/* Basic CSS */
@import "@ionic/angular/css/normalize.css";
@import "@ionic/angular/css/structure.css";
@import "@ionic/angular/css/typography.css";
@import "@ionic/angular/css/display.css";

/* Optional utils */
@import "@ionic/angular/css/padding.css";
@import "@ionic/angular/css/float-elements.css";
@import "@ionic/angular/css/text-alignment.css";
@import "@ionic/angular/css/text-transformation.css";
@import "@ionic/angular/css/flex-utils.css";

/* Dark mode palette */
@import "@ionic/angular/css/palettes/dark.system.css";

/* Leaflet */
@import "leaflet/dist/leaflet.css";

/* Full height */
html, body, ion-app, ion-content {
  height: 100%;
}

/* App font */
:root{
  --ion-font-family: "Manrope", -apple-system, BlinkMacSystemFont, "SF Pro Display",
    "Segoe UI", Roboto, Arial, sans-serif;

  /* Primary */
  --ion-color-primary: #3880ff;
  --ion-color-primary-rgb: 56,128,255;
  --ion-color-primary-contrast: #ffffff;
  --ion-color-primary-contrast-rgb: 255,255,255;
  --ion-color-primary-shade: #3171e0;
  --ion-color-primary-tint: #4c8dff;

  /* Secondary */
  --ion-color-secondary: #3dc2ff;
  --ion-color-secondary-rgb: 61,194,255;
  --ion-color-secondary-contrast: #ffffff;
  --ion-color-secondary-contrast-rgb: 255,255,255;
  --ion-color-secondary-shade: #36abe0;
  --ion-color-secondary-tint: #50c8ff;

  /* Tertiary */
  --ion-color-tertiary: #5260ff;
  --ion-color-tertiary-rgb: 82,96,255;
  --ion-color-tertiary-contrast: #ffffff;
  --ion-color-tertiary-contrast-rgb: 255,255,255;
  --ion-color-tertiary-shade: #4854e0;
  --ion-color-tertiary-tint: #6370ff;

  /* Success */
  --ion-color-success: #2dd36f;
  --ion-color-success-rgb: 45,211,111;
  --ion-color-success-contrast: #ffffff;
  --ion-color-success-contrast-rgb: 255,255,255;
  --ion-color-success-shade: #28ba62;
  --ion-color-success-tint: #42d77d;

  /* Warning */
  --ion-color-warning: #ffc409;
  --ion-color-warning-rgb: 255,196,9;
  --ion-color-warning-contrast: #000000;
  --ion-color-warning-contrast-rgb: 0,0,0;
  --ion-color-warning-shade: #e0ac08;
  --ion-color-warning-tint: #ffca22;

  /* Danger */
  --ion-color-danger: #eb445a;
  --ion-color-danger-rgb: 235,68,90;
  --ion-color-danger-contrast: #ffffff;
  --ion-color-danger-contrast-rgb: 255,255,255;
  --ion-color-danger-shade: #cf3c4f;
  --ion-color-danger-tint: #ed576b;

  /* Medium */
  --ion-color-medium: #92949c;
  --ion-color-medium-rgb: 146,148,156;
  --ion-color-medium-contrast: #ffffff;
  --ion-color-medium-contrast-rgb: 255,255,255;
  --ion-color-medium-shade: #808289;
  --ion-color-medium-tint: #9d9fa6;

  /* Light */
  --ion-color-light: #f4f5f8;
  --ion-color-light-rgb: 244,245,248;
  --ion-color-light-contrast: #000000;
  --ion-color-light-contrast-rgb: 0,0,0;
  --ion-color-light-shade: #d7d8da;
  --ion-color-light-tint: #f5f6f9;

  --um-radius: 18px;
  --um-shadow: 0 12px 30px rgba(0,0,0,0.18);
}

ion-header, ion-toolbar {
  padding-top: var(--ion-safe-area-top);
}

body.unimap-contrast {
  filter: contrast(1.08) saturate(1.05);
}

body.unimap-large ion-button {
  --padding-start: 14px;
  --padding-end: 14px;
  min-height: 44px;
}

body.unimap-large ion-toggle {
  transform: scale(1.08);
}

ion-modal.app-dialog-modal {
  --background: transparent;
  --box-shadow: none;
}

ion-modal.app-dialog-modal::part(content) {
  background: transparent;
  box-shadow: none;
}

ion-modal.app-dialog-modal::part(backdrop) {
  opacity: 0.35;
}

/* ------------------------------------
   Leaflet marker styles (your existing)
------------------------------------ */
.user-marker { position: relative; }
.user-marker .user-arrow{
  width: 28px;
  height: 28px;
  transform-origin: 50% 50%;
  display: block;
}

.leaflet-marker-icon,
.leaflet-marker-pane .leaflet-marker-icon,
.leaflet-marker-pane .leaflet-marker-icon > div,
.user-dot {
  overflow: visible !important;
}

.user-dot{
  position: relative;
  width: 28px;
  height: 28px;
}

.user-dot .dot {
  position: absolute;
  left: 50%;
  top: 50%;
  width: 14px;
  height: 14px;
  transform: translate(-50%, -50%);
  border-radius: 50%;
  background: #1a73e8;
  box-shadow: 0 0 0 3px #fff;
  z-index: 3;
}

.user-dot .halo {
  position: absolute;
  left: 50%;
  top: 50%;
  width: 26px;
  height: 26px;
  transform: translate(-50%, -50%);
  border-radius: 50%;
  background: rgba(26, 115, 232, 0.18);
  z-index: 2;
}

.user-dot .cone {
  position: absolute;
  left: 50%;
  top: 50%;
  width: 120px;
  height: 120px;

  transform: translate(-50%, -50%) rotate(0deg);
  transform-origin: 50% 50%;
  opacity: 0.24;

  z-index: 1;
  pointer-events: none;

  background: radial-gradient(
    circle at 50% 35%,
    rgba(26, 115, 232, 0.35) 0%,
    rgba(26, 115, 232, 0.18) 35%,
    rgba(26, 115, 232, 0.0) 70%
  );

  clip-path: polygon(50% 50%, 18% 0%, 82% 0%);

  transition: transform 80ms linear, opacity 160ms ease;
  will-change: transform, opacity;
  backface-visibility: hidden;
  transform-style: preserve-3d;
}

.leaflet-marker-icon.user-dot .cone{
  transition: none !important;
}

.leaflet-container,
.leaflet-control,
.leaflet-popup,
.leaflet-popup-content,
.leaflet-tooltip,
.leaflet-control-container {
  font-family: var(--ion-font-family) !important;
}

/* =========================================
   GLOBAL TYPOGRAPHY FIXES
========================================= */

html, body, ion-app, ion-content,
ion-title, ion-label, ion-text, ion-item, ion-button,
button, input, textarea, select {
  font-family: var(--ion-font-family) !important;
}

ion-searchbar::part(input) {
  font-family: var(--ion-font-family) !important;
  font-weight: 600;
}

* {
  text-transform: none !important;
}

ion-button {
  --text-transform: none;
}

* {
  font-synthesis: none;
}

.settings-content,
.settings-content * {
  font-family: var(--ion-font-family) !important;
  letter-spacing: normal !important;
  text-transform: none !important;
}

.settings-tabs ion-segment-button {
  --text-transform: none;
}

ion-popover.select-compact-popover,
ion-popover.select-compact-popover * {
  font-family: var(--ion-font-family) !important;
}

/* =========================================
   UniMap: Shared Map Loading Overlay (GLOBAL)
========================================= */
.map-loading-overlay{
  position: fixed;
  inset: 0;
  z-index: 9999;

  display: grid;
  place-items: center;
  padding: 18px;

  background: radial-gradient(
      1200px 700px at 50% 20%,
      rgba(255,255,255,0.14),
      rgba(0,0,0,0.22)
    ),
    rgba(0,0,0,0.22);

  backdrop-filter: blur(7px);
  -webkit-backdrop-filter: blur(7px);

  pointer-events: auto;

  opacity: 1;
  transition: opacity 240ms ease;
}

.map-loading-overlay.is-leaving{
  opacity: 0;
  pointer-events: none;
}

.ml-card{
  width: min(360px, calc(100vw - 34px));
  padding: 16px 16px 14px;
  border-radius: 20px;

  background: rgba(255, 255, 255, 0.92);
  border: 1px solid rgba(255,255,255,0.55);

  box-shadow:
    0 18px 46px rgba(0,0,0,0.22),
    0 2px 0 rgba(255,255,255,0.55) inset;

  display: grid;
  gap: 10px;
  text-align: center;

  animation: mlPop 320ms ease both;
  position: relative;
  overflow: hidden;
}

.ml-card::before{
  content: "";
  position: absolute;
  inset: -2px;
  background: linear-gradient(
    120deg,
    rgba(255,255,255,0) 0%,
    rgba(255,255,255,0.35) 28%,
    rgba(255,255,255,0) 56%
  );
  transform: translateX(-55%);
  animation: mlShimmer 1.6s ease-in-out infinite;
  pointer-events: none;
}

.ml-title{
  font-weight: 800;
  font-size: 16px;
  letter-spacing: -0.25px;
  color: #0f172a;
  position: relative;
}

.ml-percent{
  font-weight: 800;
  font-size: 13px;
  opacity: 0.9;
  position: relative;
}

.ml-sub{
  font-size: 12px;
  font-weight: 800;
  opacity: 0.7;
  position: relative;
}

.ml-card ion-spinner{
  width: 34px;
  height: 34px;
  margin: 0 auto;
  position: relative;
}

@keyframes mlPop{
  from { transform: translateY(6px) scale(0.98); opacity: 0.2; }
  to   { transform: translateY(0) scale(1); opacity: 1; }
}

@keyframes mlShimmer{
  0%   { transform: translateX(-60%); opacity: 0.65; }
  55%  { transform: translateX(60%);  opacity: 0.65; }
  100% { transform: translateX(60%);  opacity: 0; }
}

@supports not ((backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px))){
  .map-loading-overlay{ background: rgba(0,0,0,0.32); }
}

